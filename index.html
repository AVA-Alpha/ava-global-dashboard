<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans+Condensed:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <link rel="stylesheet" href="./styles.css">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
    

    </link>
    <title>AVA Fundamental Dashboard</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">
            <img src="https://avaadvisory.hk/wp-content/uploads/2019/02/AVA-logo-color@2x-1.png" width="30" height="30" class="d-inline-block align-top" alt="">
            AVA Fundamental Dashboard
          </a>

          <select class="js-example-basic-single"  name="state">
            <option value="AAPL">(AAPL) Apple [NASDAQ]</option>
            <option value="NFLX">(NFLX) Netflix [NASDAQ]</option>
            <option value="ENT">ENT</option>
          </select>
    
          <!-- <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" id="symbolSearch" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" id="submitBtn" type="submit">Search</button>
          </form> -->
        </div>
      </nav>
      
    <div class="flex-container">
        <div class="flex-row">
            <div class="flex-item" id="price-chart"></div>
            <div class="flex-item " id="information">
                <div class="row">
                    <!-- Information -->
                    <div class="col-5">
                        <div class="row">
                            <div class="col-8" id="information-symbol"></div>
                            <div class="col-4">
                                <div class="row">
                                    <div class="col-1 information-currency" id="information-currency"></div>
                                    <div class="col-2" id="information-price"></div>
                                </div>
                                <!-- <div class="information-currency" id="information-currency"></div> 
                                <div id="information-price"></div>  -->
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-8" id="information-name"></div>
                            <div class="col-4"> 
                                <div class="" id="information-chg-arrow"></div> 
                                <div id="information-chg"></div> 
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12" id="information-sector"></div>
                        </div>
                        <div class="row">
                            <div class="col-12" id="information-desc"></div>
                        </div>
                    </div>
                    <!-- Scores -->
                    <div class="col-5">
                        <div class="row">
                            <div class="col-12 metric-text" id="icr-text"></div>
                            <div class="col-12"><canvas id="icr-score" height="20"></canvas></div>
                        </div>
                        <div class="row">
                            <div class="col-12 metric-text" id="la-text"></div>
                            <div class="col-12"><canvas id="la-score" height="20"></canvas></div>
                        </div>
                        <div class="row">
                            <div class="col-12 metric-text" id="ocq-text"></div>
                            <div class="col-12"><canvas id="ocq-score" height="20"></canvas></div>
                        </div>
                        <div class="row">
                            <div class="col-12 metric-text" id="rev-text"></div>
                            <div class="col-12"><canvas id="rev-score" height="20"></canvas></div>
                        </div>
                        <div class="row">
                            <div class="col-12 metric-text" id="valuation-text"></div>
                            <div class="col-12"><canvas id="valuation-score" height="20"></canvas></div>
                        </div>
                    </div>
                    <!-- AVA Score-->
                    <div class="col-2">
                        <div class="ava-scorebox">
                            <div class="row avascore" id="avascore"></div>
                            <div class="row avatext">AVA SCORE</div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex-row">
            <div>
                <div class="flex-item" id="ic-chart">
                    <div id="tooltip" class="tooltip">
                        <div class="tooltip-range">
                            Growth: <span id="range"></span>
                        </div>
                        <div class="tooltip-value">
                            <span id="count"></span> days
                        </div>
                    </div>
                </div>
                <div class="flex-item" id="ic-areachart"></div>
            </div>
            <div class="flex-item" id="ic-table"></div>
        </div>

        <div class="flex-row">
            <div class="flex-item" id="bs-chart"></div>
            <div class="flex-item" id="bs-table"></div>
        </div>

        <div class="flex-row">
            <div class="flex-item" id="cs-chart"></div>
            <div class="flex-item" id="cs-table"></div>
        </div>
    </div>

    <div id="wrapper"></div>

    <script src="./d3.js"></script>
    <script src="./mediator.js"></script>
    <script src="./pricechart.js"></script>
    <script src="./stepline.js"></script>
    <script src="./table.js"></script>
    <script src="./linepointchart.js"></script>
    <script src="./areachart.js"></script>
    <script src="./info.js"></script>
    <script src="./vis.js"></script>

    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>

<script>
    // $(document).ready(function() {
    //     $('.js-example-basic-single').select2();
    // });
    // $('.js-example-basic-single').on('select2:select', function (e) {
    // var data = e.params.data;
    // draw(data['id'])
    // });

    function formatState (state) {
        console.log(state);
        return `(${state.id}) ${state.text}`;
    };
    $(document).ready(function() {
        $(".js-example-basic-single").select2({
        minimumInputLength: 2,
        templateResult: formatState, //this is for append country flag.
        ajax: {
            url: 'http://18.141.209.89:1323/api/search',
            dataType: 'json',
            type: "GET",
            headers: {
                'Authorization':'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE4OTM0NTYwMDAsInVzZXJuYW1lIjoieW9ydCJ9.GGYlZFvQfYJTT3VU6owQXImwD3tsO9HICMG83sgSPYU',
                'Content-Type':'application/json'
            },
            data: function (params) {
                return {
                    symbol: params.term,
                    limit: 10
                };
            },
            processResults: function (data) {
                console.log(data)
                return {
                    results: $.map(data, function (item) {
                        return {
                            text: item.description,
                            id: item.symbol,
                            //contryflage:item.state.coutry.sortname
                        }
                    })
                };
            }
        }
        });
        $('.js-example-basic-single').on('select2:select', function (e) {
            var data = e.params.data;
            draw(data['id'])
        });
    });
</script>
</body>

</html>